#!/bin/bash

CUSTOM_ROOT="/usr/local/.programs"

mkdir -p "${CUSTOM_ROOT}"
cd "${CUSTOM_ROOT}"

apt-get update
apt-get install -y -q=5 unzip openjdk-11-jdk gdb python3 git python3-pip

cd "${CUSTOM_ROOT}"
python3 -m pip -q install --upgrade pip
python3 -m pip -q install --upgrade pwntools
wget --quiet "https://ghidra-sre.org/ghidra_9.2.2_PUBLIC_20201229.zip"
unzip -q "ghidra_9.2.2_PUBLIC_20201229.zip"
cd "ghidra_9.2.2_PUBLIC"
printf "export PATH=${PATH}:$(pwd)\n" >> /etc/profile

cd "${CUSTOM_ROOT}"
git clone https://github.com/pwndbg/pwndbg
cd pwndbg
./setup.sh

mkdir -p /etc/gdb/
cat <<- _EOF_ >> /etc/gdb/gdbinit
    source $(pwd)/gdbinit.py
_EOF_

printf "Done! Use the following command to log in: %s\n" "vagrant ssh -- -X"
printf "To use Ghidra, use the command: %s\n" "ghidraRun"
